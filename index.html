<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>N-CLICKER</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: #000000;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        .app {
            width: 100%;
            max-width: 390px;
            background: #0a0c10;
            border-radius: 32px;
            overflow: hidden;
            border: 1px solid #1e1e1e;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8);
        }

        /* Главный экран */
        .main-screen {
            padding: 28px 24px 24px 24px;
            background: #0a0c10;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .player-name {
            font-size: 17px;
            font-weight: 500;
            color: #8e8e93;
            letter-spacing: 0.3px;
            margin-bottom: 16px;
            width: 100%;
            text-align: left;
        }

        .balance {
            font-size: 64px;
            font-weight: 700;
            color: #ffffff;
            line-height: 1;
            margin-bottom: 24px;
            font-feature-settings: "tnum";
            text-align: center;
            letter-spacing: 2px;
        }

        .stats-row {
            display: flex;
            gap: 48px;
            margin-bottom: 40px;
            justify-content: center;
            width: 100%;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .stat-value {
            font-size: 22px;
            font-weight: 600;
            color: #ffffff;
            letter-spacing: 0.2px;
        }

        .stat-label {
            font-size: 14px;
            color: #8e8e93;
            margin-top: 4px;
        }

        /* Центральная кнопка N */
        .click-area {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 16px 0 32px 0;
        }

        .n-button {
            width: 200px;
            height: 200px;
            background: #ffffff;
            border-radius: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            font-weight: 800;
            color: #000000;
            box-shadow: 0 10px 0 #666666, 0 20px 30px rgba(0, 0, 0, 0.6);
            transition: all 0.08s linear;
            cursor: pointer;
            border: none;
            line-height: 1;
        }

        .n-button:active {
            transform: translateY(8px);
            box-shadow: 0 2px 0 #666666, 0 15px 25px rgba(0, 0, 0, 0.6);
        }

        /* Навигация - увеличенная */
        .nav-bar {
            display: flex;
            justify-content: space-around;
            background: #0f1218;
            padding: 16px 0 20px 0;
            border-top: 1px solid #1e1e1e;
            border-bottom: 1px solid #1e1e1e;
        }

        .nav-item {
            color: #5e5e62;
            font-size: 14px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 8px 0;
            cursor: pointer;
            transition: color 0.2s;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .nav-item svg {
            width: 24px;
            height: 24px;
            stroke: #5e5e62;
            stroke-width: 1.5;
            fill: none;
        }

        .nav-item.active {
            color: #ffffff;
        }

        .nav-item.active svg {
            stroke: #ffffff;
        }

        .nav-item.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 20%;
            width: 60%;
            height: 2px;
            background: #ffffff;
        }

        /* Контентные панели */
        .content-panel {
            background: #0a0c10;
            padding: 24px;
            min-height: 450px;
        }

        .panel {
            display: none;
        }

        .panel.active {
            display: block;
        }

        /* Иконки для навигации */
        .icon-games, .icon-shop, .icon-rating, .icon-profile, .icon-promo {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Игры */
        .game-card {
            background: #12141c;
            border-radius: 24px;
            padding: 20px;
            margin-bottom: 16px;
            border: 1px solid #252525;
        }

        .game-title {
            font-size: 22px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 8px;
        }

        .game-desc {
            font-size: 13px;
            color: #7c7c82;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        .play-btn {
            background: #ffffff;
            color: #000000;
            border: none;
            border-radius: 30px;
            padding: 12px 24px;
            font-size: 15px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            box-shadow: 0 5px 0 #666666;
            transition: all 0.08s;
            border: none;
            min-width: 120px;
        }

        .play-btn:active {
            transform: translateY(4px);
            box-shadow: 0 1px 0 #666666;
        }

        .play-btn svg {
            width: 18px;
            height: 18px;
            stroke: #000000;
            stroke-width: 2;
        }

        .lottery-info {
            margin-top: 20px;
            background: #0f1218;
            border-radius: 18px;
            padding: 16px;
            border: 1px solid #252525;
        }

        .timer {
            font-size: 36px;
            font-weight: 700;
            color: #ffffff;
            font-feature-settings: "tnum";
            margin-bottom: 8px;
        }

        .chance-text {
            color: #7c7c82;
            font-size: 14px;
            margin-bottom: 12px;
        }

        .players-list {
            color: #a0a0a5;
            font-size: 13px;
        }

        .player-row {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            border-bottom: 1px solid #252525;
        }

        /* Магазин */
        .shop-item {
            background: #12141c;
            border-radius: 20px;
            padding: 16px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #252525;
        }

        .item-info h4 {
            color: #ffffff;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .item-info p {
            color: #7c7c82;
            font-size: 13px;
        }

        .item-price {
            color: #ffffff;
            font-size: 20px;
            font-weight: 600;
            margin-right: 12px;
        }

        .buy-btn {
            background: #2a2a2e;
            color: #ffffff;
            border: none;
            border-radius: 30px;
            padding: 8px 20px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            border: 1px solid #3a3a3e;
        }

        /* Рейтинг */
        .rating-header {
            display: flex;
            justify-content: space-between;
            color: #7c7c82;
            font-size: 13px;
            padding: 12px 0;
            border-bottom: 1px solid #252525;
            margin-bottom: 8px;
        }

        .rating-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px dashed #252525;
            color: #ffffff;
            font-size: 15px;
        }

        /* Профиль */
        .profile-section {
            background: #12141c;
            border-radius: 24px;
            padding: 20px;
            border: 1px solid #252525;
        }

        .profile-stat {
            display: flex;
            justify-content: space-between;
            margin: 12px 0;
            color: #ffffff;
        }

        .nick-input {
            background: #0f1218;
            border: 1px solid #333;
            color: #ffffff;
            padding: 14px;
            border-radius: 40px;
            width: 100%;
            margin: 16px 0;
            font-size: 15px;
        }

        .color-options {
            display: flex;
            gap: 12px;
            margin: 16px 0;
        }

        .color-dot {
            width: 44px;
            height: 44px;
            border-radius: 44px;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .color-dot.selected {
            border-color: #ffffff;
        }

        .save-btn {
            background: #ffffff;
            color: #000;
            border: none;
            border-radius: 40px;
            padding: 14px;
            font-weight: 600;
            width: 100%;
            font-size: 16px;
            cursor: pointer;
            box-shadow: 0 5px 0 #666;
            transition: 0.08s;
        }

        .save-btn:active {
            transform: translateY(4px);
            box-shadow: 0 1px 0 #666;
        }

        /* Промокоды */
        .promo-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }

        .promo-tab {
            flex: 1;
            text-align: center;
            padding: 14px;
            background: #12141c;
            border-radius: 40px;
            color: #7c7c82;
            font-weight: 600;
            cursor: pointer;
            border: 1px solid #252525;
        }

        .promo-tab.active {
            background: #ffffff;
            color: #000;
            border-color: #fff;
        }

        .promo-form input {
            width: 100%;
            padding: 16px;
            background: #12141c;
            border: 1px solid #333;
            border-radius: 40px;
            margin: 8px 0;
            color: #fff;
            font-size: 15px;
        }

        .promo-form button {
            width: 100%;
            padding: 16px;
            background: #fff;
            color: #000;
            border: none;
            border-radius: 40px;
            font-weight: 600;
            font-size: 16px;
            margin-top: 8px;
            cursor: pointer;
            box-shadow: 0 5px 0 #666;
            transition: 0.08s;
        }

        .promo-form button:active {
            transform: translateY(4px);
            box-shadow: 0 1px 0 #666;
        }

        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="app">
        <!-- Верхняя часть -->
        <div class="main-screen">
            <div class="player-name" id="playerNameDisplay">Игрок</div>
            <div class="balance" id="balanceDisplay">0.000</div>
            
            <div class="stats-row">
                <div class="stat-item">
                    <span class="stat-value" id="perSecondDisplay">+0.000</span>
                    <span class="stat-label">/сек</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="perClickDisplay">+0.000</span>
                    <span class="stat-label">/клик</span>
                </div>
            </div>

            <!-- Большая кнопка N -->
            <div class="click-area">
                <button class="n-button" id="clickButton">N</button>
            </div>
        </div>

        <!-- Навигация с минималистичными иконками -->
        <div class="nav-bar">
            <div class="nav-item active" data-panel="games">
                <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="2" y="6" width="20" height="12" rx="2" ry="2"></rect>
                    <circle cx="8" cy="12" r="1.5"></circle>
                    <circle cx="16" cy="12" r="1.5"></circle>
                    <line x1="9" y1="12" x2="15" y2="12"></line>
                </svg>
                <span>ИГРЫ</span>
            </div>
            <div class="nav-item" data-panel="shop">
                <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <path d="M16 10a4 4 0 0 1-8 0"></path>
                </svg>
                <span>МАГАЗИН</span>
            </div>
            <div class="nav-item" data-panel="rating">
                <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="12" y1="20" x2="12" y2="10"></line>
                    <line x1="18" y1="20" x2="18" y2="4"></line>
                    <line x1="6" y1="20" x2="6" y2="16"></line>
                </svg>
                <span>РЕЙТИНГ</span>
            </div>
            <div class="nav-item" data-panel="profile">
                <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
                <span>ПРОФИЛЬ</span>
            </div>
            <div class="nav-item" data-panel="promo">
                <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
                    <line x1="7" y1="7" x2="7.01" y2="7"></line>
                </svg>
                <span>ПРОМО</span>
            </div>
        </div>

        <!-- Контент -->
        <div class="content-panel">
            <!-- ИГРЫ -->
            <div class="panel active" id="games">
                <div class="game-card">
                    <div class="game-title">ЛОТЕРЕЯ</div>
                    <div class="game-desc">Минимальная ставка 0.001 NC. Один победитель</div>
                    <button class="play-btn" id="playLottery1">
                        <svg viewBox="0 0 24 24" fill="none">
                            <polygon points="5 3 19 12 5 21 5 3" fill="black" stroke="none"/>
                        </svg>
                        ИГРАТЬ
                    </button>
                    <div class="lottery-info" id="lottery1Info">
                        <div class="timer" id="lottery1Timer">00:00</div>
                        <div class="chance-text">Ваш шанс: <span id="lottery1Chance">0%</span></div>
                        <div class="players-list" id="lottery1Players"></div>
                    </div>
                </div>

                <div class="game-card">
                    <div class="game-title">КОМАНДНАЯ ЛОТЕРЕЯ</div>
                    <div class="game-desc">Выберите команду. Нельзя ставить за обе</div>
                    <button class="play-btn" id="playLottery2">
                        <svg viewBox="0 0 24 24" fill="none">
                            <polygon points="5 3 19 12 5 21 5 3" fill="black" stroke="none"/>
                        </svg>
                        ИГРАТЬ
                    </button>
                    <div class="lottery-info" id="lottery2Info">
                        <div class="timer" id="lottery2Timer">00:00</div>
                        <div>Команда A: <span id="teamAPlayers">0</span></div>
                        <div>Команда B: <span id="teamBPlayers">0</span></div>
                        <div>Ваша команда: <span id="userTeam">—</span></div>
                    </div>
                </div>
            </div>

            <!-- МАГАЗИН -->
            <div class="panel" id="shop">
                <div class="shop-item">
                    <div><h4>+0.01/клик</h4><p>Улучшение клика</p></div>
                    <div><span class="item-price">10</span><button class="buy-btn" data-type="click">Купить</button></div>
                </div>
                <div class="shop-item">
                    <div><h4>+0.01/сек</h4><p>Пассивный доход</p></div>
                    <div><span class="item-price">15</span><button class="buy-btn" data-type="sec">Купить</button></div>
                </div>
                <div class="shop-item">
                    <div><h4>+0.1/клик</h4><p>Супер клик</p></div>
                    <div><span class="item-price">50</span><button class="buy-btn" data-type="superclick">Купить</button></div>
                </div>
                <div class="shop-item">
                    <div><h4>+0.2/сек</h4><p>Авто-фермер</p></div>
                    <div><span class="item-price">80</span><button class="buy-btn" data-type="autofarm">Купить</button></div>
                </div>
            </div>

            <!-- РЕЙТИНГ -->
            <div class="panel" id="rating">
                <div class="rating-header"><span>ИГРОК</span><span>БАЛАНС</span></div>
                <div id="ratingList"></div>
            </div>

            <!-- ПРОФИЛЬ -->
            <div class="panel" id="profile">
                <div class="profile-section">
                    <div class="profile-stat"><span>Сегодня:</span><span id="todayEarn">0.000 NC</span></div>
                    <div class="profile-stat"><span>Всего времени:</span><span id="totalTime">0 сек</span></div>
                    <div class="profile-stat"><span>Кликов:</span><span id="totalClicks">0</span></div>
                    
                    <input type="text" class="nick-input" id="nickInput" value="Игрок" placeholder="Ваш ник">
                    
                    <div class="color-options" id="colorPicker">
                        <div class="color-dot selected" style="background:#ffffff;" data-color="#ffffff"></div>
                        <div class="color-dot" style="background:#3b82f6;" data-color="#3b82f6"></div>
                        <div class="color-dot" style="background:#ef4444;" data-color="#ef4444"></div>
                        <div class="color-dot" style="background:#10b981;" data-color="#10b981"></div>
                    </div>

                    <button class="save-btn" id="saveProfile">СОХРАНИТЬ (50 NC)</button>
                </div>
            </div>

            <!-- ПРОМОКОДЫ -->
            <div class="panel" id="promo">
                <div class="promo-tabs">
                    <div class="promo-tab active" data-tab="create">СОЗДАТЬ</div>
                    <div class="promo-tab" data-tab="apply">ПРИМЕНИТЬ</div>
                </div>

                <div id="createPromoPanel" class="promo-form">
                    <input type="text" id="promoName" placeholder="Название">
                    <input type="number" id="promoSum" placeholder="Сумма NC">
                    <input type="number" id="promoActivations" placeholder="Кол-во активаций">
                    <button id="createPromoBtn">СОЗДАТЬ ПРОМОКОД</button>
                </div>

                <div id="applyPromoPanel" class="promo-form hidden">
                    <input type="text" id="promoCode" placeholder="Введите промокод">
                    <button id="applyPromoBtn">ПРИМЕНИТЬ</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        (function() {
            // Состояние
            let user = {
                name: 'Игрок',
                balance: 0.000,
                perClick: 0.000,
                perSecond: 0.000,
                color: '#ffffff',
                totalClicks: 0,
                todayEarn: 0,
                registerTime: Date.now()
            };

            // Лотерея 1
            let lottery1 = {
                active: false,
                players: [], // { name, amount }
                totalPool: 0,
                timer: 0,
                endTime: null,
                interval: null
            };

            // Лотерея 2
            let lottery2 = {
                active: false,
                teamA: [],
                teamB: [],
                timer: 0,
                endTime: null,
                interval: null
            };

            // Промокоды
            let promos = [];

            // Рейтинг (демо)
            let ratingPlayers = [];

            // DOM элементы
            const balanceEl = document.getElementById('balanceDisplay');
            const perSecEl = document.getElementById('perSecondDisplay');
            const perClickEl = document.getElementById('perClickDisplay');
            const playerNameEl = document.getElementById('playerNameDisplay');
            const clickBtn = document.getElementById('clickButton');

            // Обновление UI
            function updateUI() {
                balanceEl.textContent = user.balance.toFixed(3);
                perSecEl.textContent = '+' + user.perSecond.toFixed(3);
                perClickEl.textContent = '+' + user.perClick.toFixed(3);
                playerNameEl.textContent = user.name;
                playerNameEl.style.color = user.color;

                // Лотерея 1
                if (lottery1.active) {
                    document.getElementById('lottery1Timer').textContent = formatTime(lottery1.timer);
                    let player = lottery1.players.find(p => p.name === user.name);
                    let chance = player ? (player.amount / lottery1.totalPool * 100).toFixed(2) : '0';
                    document.getElementById('lottery1Chance').textContent = chance + '%';
                    
                    let playersHtml = '';
                    lottery1.players.forEach(p => {
                        playersHtml += `<div class="player-row"><span>${p.name}</span><span>${p.amount.toFixed(3)}</span></div>`;
                    });
                    document.getElementById('lottery1Players').innerHTML = playersHtml || '<div>Нет участников</div>';
                } else {
                    document.getElementById('lottery1Timer').textContent = '00:00';
                    document.getElementById('lottery1Chance').textContent = '0%';
                    document.getElementById('lottery1Players').innerHTML = '<div>Лотерея неактивна</div>';
                }

                // Лотерея 2
                if (lottery2.active) {
                    document.getElementById('lottery2Timer').textContent = formatTime(lottery2.timer);
                    document.getElementById('teamAPlayers').textContent = lottery2.teamA.length;
                    document.getElementById('teamBPlayers').textContent = lottery2.teamB.length;
                    let userTeam = '—';
                    if (lottery2.teamA.includes(user.name)) userTeam = 'A';
                    else if (lottery2.teamB.includes(user.name)) userTeam = 'B';
                    document.getElementById('userTeam').textContent = userTeam;
                } else {
                    document.getElementById('lottery2Timer').textContent = '00:00';
                    document.getElementById('teamAPlayers').textContent = '0';
                    document.getElementById('teamBPlayers').textContent = '0';
                    document.getElementById('userTeam').textContent = '—';
                }

                // Рейтинг
                let allPlayers = [
                    { name: user.name, balance: user.balance, color: user.color },
                    ...ratingPlayers
                ].sort((a,b) => b.balance - a.balance).slice(0, 10);
                
                let ratingHtml = '';
                if (allPlayers.length === 0) {
                    ratingHtml = '<div class="rating-row">Нет игроков</div>';
                } else {
                    allPlayers.forEach(p => {
                        ratingHtml += `<div class="rating-row"><span style="color:${p.color}">${p.name}</span><span>${p.balance.toFixed(3)}</span></div>`;
                    });
                }
                document.getElementById('ratingList').innerHTML = ratingHtml;

                // Профиль
                document.getElementById('todayEarn').textContent = user.todayEarn.toFixed(3) + ' NC';
                let totalSec = Math.floor((Date.now() - user.registerTime) / 1000);
                document.getElementById('totalTime').textContent = totalSec + ' сек';
                document.getElementById('totalClicks').textContent = user.totalClicks;
                document.getElementById('nickInput').value = user.name;

                // Цвет в профиле
                document.querySelectorAll('.color-dot').forEach(el => {
                    if (el.dataset.color === user.color) el.classList.add('selected');
                    else el.classList.remove('selected');
                });
            }

            function formatTime(seconds) {
                let mins = Math.floor(seconds / 60);
                let secs = Math.floor(seconds % 60);
                return `${mins.toString().padStart(2,'0')}:${secs.toString().padStart(2,'0')}`;
            }

            // Клик по N - теперь дает 0.001
            clickBtn.addEventListener('click', function() {
                user.balance += 0.001;
                user.totalClicks++;
                user.todayEarn += 0.001;
                updateUI();
                
                this.style.transform = 'translateY(8px)';
                this.style.boxShadow = '0 2px 0 #666666, 0 15px 25px rgba(0,0,0,0.6)';
                setTimeout(() => {
                    this.style.transform = '';
                    this.style.boxShadow = '0 10px 0 #666666, 0 20px 30px rgba(0,0,0,0.6)';
                }, 80);
            });

            // Пассивный доход
            setInterval(() => {
                user.balance += user.perSecond;
                user.todayEarn += user.perSecond;
                updateUI();
            }, 1000);

            // Навигация
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
                    document.getElementById(this.dataset.panel).classList.add('active');
                });
            });

            // Лотерея 1
            document.getElementById('playLottery1').addEventListener('click', function() {
                let bet = 0.001;
                if (user.balance < bet) { alert('Недостаточно NC'); return; }

                if (!lottery1.active) {
                    // Первая ставка - запуск
                    user.balance -= bet;
                    lottery1.players = [{ name: user.name, amount: bet }];
                    lottery1.totalPool = bet;
                    lottery1.active = true;
                    lottery1.timer = 120;
                    lottery1.endTime = Date.now() + 120000;
                    
                    if (lottery1.interval) clearInterval(lottery1.interval);
                    lottery1.interval = setInterval(() => {
                        let remaining = Math.max(0, (lottery1.endTime - Date.now()) / 1000);
                        lottery1.timer = remaining;
                        
                        if (remaining <= 0) {
                            clearInterval(lottery1.interval);
                            lottery1.active = false;
                            
                            if (lottery1.players.length > 0) {
                                let rand = Math.random() * lottery1.totalPool;
                                let sum = 0;
                                let winner = null;
                                for (let p of lottery1.players) {
                                    sum += p.amount;
                                    if (rand <= sum) { winner = p; break; }
                                }
                                if (winner) {
                                    alert(`Победитель: ${winner.name} получает ${lottery1.totalPool.toFixed(3)} NC`);
                                    if (winner.name === user.name) {
                                        user.balance += lottery1.totalPool;
                                    }
                                }
                            }
                            lottery1.players = [];
                            lottery1.totalPool = 0;
                        }
                        updateUI();
                    }, 100);
                } else {
                    // Добавление ставки
                    user.balance -= bet;
                    let player = lottery1.players.find(p => p.name === user.name);
                    if (player) {
                        player.amount += bet;
                    } else {
                        lottery1.players.push({ name: user.name, amount: bet });
                    }
                    lottery1.totalPool += bet;
                }
                updateUI();
            });

            // Лотерея 2
            document.getElementById('playLottery2').addEventListener('click', function() {
                if (!lottery2.active) {
                    let team = prompt('Выберите команду A или B').toUpperCase();
                    if (team !== 'A' && team !== 'B') return;
                    
                    if (user.balance < 0.001) { alert('Недостаточно NC'); return; }
                    user.balance -= 0.001;
                    
                    lottery2.active = true;
                    lottery2.timer = 120;
                    lottery2.endTime = Date.now() + 120000;
                    lottery2.teamA = [];
                    lottery2.teamB = [];
                    
                    if (team === 'A') lottery2.teamA.push(user.name);
                    else lottery2.teamB.push(user.name);
                    
                    if (lottery2.interval) clearInterval(lottery2.interval);
                    lottery2.interval = setInterval(() => {
                        let remaining = Math.max(0, (lottery2.endTime - Date.now()) / 1000);
                        lottery2.timer = remaining;
                        
                        if (remaining <= 0) {
                            clearInterval(lottery2.interval);
                            lottery2.active = false;
                            
                            if (lottery2.teamA.length > lottery2.teamB.length) {
                                alert('Победила команда A!');
                                if (lottery2.teamA.includes(user.name)) {
                                    user.balance += (lottery2.teamA.length + lottery2.teamB.length) * 0.001;
                                }
                            } else if (lottery2.teamB.length > lottery2.teamA.length) {
                                alert('Победила команда B!');
                                if (lottery2.teamB.includes(user.name)) {
                                    user.balance += (lottery2.teamA.length + lottery2.teamB.length) * 0.001;
                                }
                            } else {
                                alert('Ничья! Возврат ставок');
                                if (lottery2.teamA.includes(user.name) || lottery2.teamB.includes(user.name)) {
                                    user.balance += 0.001;
                                }
                            }
                            lottery2.teamA = [];
                            lottery2.teamB = [];
                        }
                        updateUI();
                    }, 100);
                } else {
                    if (lottery2.teamA.includes(user.name) || lottery2.teamB.includes(user.name)) {
                        alert('Вы уже сделали ставку!');
                        return;
                    }
                    
                    let team = prompt('Выберите команду A или B').toUpperCase();
                    if (team !== 'A' && team !== 'B') return;
                    
                    if (user.balance < 0.001) { alert('Недостаточно NC'); return; }
                    user.balance -= 0.001;
                    
                    if (team === 'A') lottery2.teamA.push(user.name);
                    else lottery2.teamB.push(user.name);
                }
                updateUI();
            });

            // Магазин
            document.querySelectorAll('.buy-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    let type = this.dataset.type;
                    if (type === 'click' && user.balance >= 10) {
                        user.balance -= 10;
                        user.perClick += 0.01;
                    } else if (type === 'sec' && user.balance >= 15) {
                        user.balance -= 15;
                        user.perSecond += 0.01;
                    } else if (type === 'superclick' && user.balance >= 50) {
                        user.balance -= 50;
                        user.perClick += 0.1;
                    } else if (type === 'autofarm' && user.balance >= 80) {
                        user.balance -= 80;
                        user.perSecond += 0.2;
                    } else {
                        alert('Недостаточно NC');
                        return;
                    }
                    updateUI();
                });
            });

            // Профиль
            document.getElementById('saveProfile').addEventListener('click', function() {
                if (user.balance < 50) { alert('Нужно 50 NC'); return; }
                
                let newName = document.getElementById('nickInput').value.trim();
                if (newName) user.name = newName;
                
                let selectedColor = document.querySelector('.color-dot.selected')?.dataset.color;
                if (selectedColor) user.color = selectedColor;
                
                user.balance -= 50;
                updateUI();
            });

            document.querySelectorAll('.color-dot').forEach(el => {
                el.addEventListener('click', function() {
                    document.querySelectorAll('.color-dot').forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });

            // Промокоды - табы
            document.querySelectorAll('[data-tab]').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('[data-tab]').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    if (this.dataset.tab === 'create') {
                        document.getElementById('createPromoPanel').classList.remove('hidden');
                        document.getElementById('applyPromoPanel').classList.add('hidden');
                    } else {
                        document.getElementById('createPromoPanel').classList.add('hidden');
                        document.getElementById('applyPromoPanel').classList.remove('hidden');
                    }
                });
            });

            // Создать промокод
            document.getElementById('createPromoBtn').addEventListener('click', function() {
                let name = document.getElementById('promoName').value.trim();
                let sum = parseFloat(document.getElementById('promoSum').value);
                let acts = parseInt(document.getElementById('promoActivations').value);
                
                if (!name || isNaN(sum) || isNaN(acts) || sum <= 0 || acts <= 0) {
                    alert('Неверные данные');
                    return;
                }
                
                if (user.balance < sum * acts) {
                    alert('Недостаточно NC для создания');
                    return;
                }
                
                user.balance -= sum * acts;
                promos.push({ code: name, amount: sum, remaining: acts });
                alert('Промокод создан!');
                updateUI();
            });

            // Применить промокод
            document.getElementById('applyPromoBtn').addEventListener('click', function() {
                let code = document.getElementById('promoCode').value.trim();
                let promo = promos.find(p => p.code === code && p.remaining > 0);
                
                if (!promo) {
                    alert('Недействительный промокод');
                    return;
                }
                
                user.balance += promo.amount;
                promo.remaining--;
                alert(`Получено ${promo.amount} NC!`);
                updateUI();
            });

            // Инициализация
            updateUI();
        })();
    </script>
</body>
</html>